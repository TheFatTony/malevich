<section class="g-brd-bottom g-brd-gray-light-v4 g-py-30">
  <div class="container">
    <div class="d-sm-flex text-center">
      <div class="align-self-center">
        <ul class="u-list-inline">
          <li class="list-inline-item g-mr-5">
            <a class="u-link-v5 g-color-text" routerLink="/main-page">{{'INDEX.MAIN_MENU_ITEM' | translate}}</a>
            <i class="g-color-gray-light-v2 g-ml-5 fa fa-angle-right"></i>
          </li>
          <li class="list-inline-item g-mr-5">
            <a class="u-link-v5 g-color-text" routerLink="/profile/view">{{'PROFILE.TITLE' |
              translate}}</a>
            <i class="g-color-gray-light-v2 g-ml-5 fa fa-angle-right"></i>
          </li>
          <li class="list-inline-item g-color-primary">
            <span> {{"PROFILE.WALLET.TITLE" | translate}}</span>
          </li>
        </ul>
      </div>

      <div class="align-self-center ml-auto">
        <h1 class="h3 mb-0"> {{"PROFILE.WALLET.TITLE" | translate}}</h1>
      </div>
    </div>
  </div>
</section>

<div class="container g-pt-70 g-pb-30">
  <div class="row">
    <!-- Profile Settings -->
    <div class="col-lg-3 g-mb-50">
      <app-profile-navigation></app-profile-navigation>
    </div>
    <!-- End Profile Settings -->

    <div class="col-lg-9 g-mb-50">
      <!-- Wallet -->
      <!-- Balance & Rewards -->
      <div class="g-brd-around g-brd-gray-light-v4 rounded g-px-30 g-pt-30">
        <!--<h3 class="h5 mb-3">{{"PROFILE.WALLET.BALANCE" | translate}}</h3>-->

        <div class="row g-mb-30">
          <div class="col">
            <div class="row justify-content-center">
              <div class="col-lg-4">
                <mchButton
                  class="btn btn-block u-btn-primary g-font-size-12 text-uppercase g-py-15 g-px-5"
                  (click)="openDepositWindow()"
                  [height]="null">
                  <i class="align-middle g-font-size-16 mr-2 icon-finance-053 u-line-icon-pro"></i>
                  {{"PROFILE.BUTTON.DEPOSIT" | translate}}
                </mchButton>
              </div>
              <div class="col-lg-4">
                <mchButton
                  class="btn btn-block u-btn-primary g-font-size-12 text-uppercase g-py-15 g-px-5"
                  (click)="openWithdrawWindow()"
                  [disabled]="!hasWithdrawalAccess"
                  [height]="null">
                  <i class="align-middle g-font-size-16 mr-2 icon-finance-210 u-line-icon-pro"></i>
                  {{"PROFILE.BUTTON.WITHDRAW" | translate}}
                </mchButton>
              </div>
            </div>
          </div>
        </div>
        <!-- Balance Info -->
        <div class="row justify-content-center g-mb-30">
          <div class="col-sm-4">
            <div class="g-bg-gray-dark-v3 text-center rounded g-px-20 g-py-30">
              <span class="d-block g-color-white-opacity-0_8 g-font-size-18 mb-1">{{"PROFILE.WALLET.AVAILABLE" | translate}} {{"PROFILE.WALLET.BALANCE" | translate}}</span>
              <span class="d-block g-color-white g-font-weight-600 g-font-size-25">SQR {{accountState?.amount | number:'1.0-2'}}</span>
            </div>
          </div>

        </div>
        <!-- End Balance Info -->

        <!-- Add Balance -->

        <div class="row">
          <div class="col">
            <jqxGrid #myGrid
                     [width]="'100%'"
                     [height]="'320px'"
                     class="g-mt-5 g-mb-15"
                     [sortable]="true"
                     [columnsresize]="true"
                     [filterable]="true"
                     [autoshowfiltericon]="true">
              <tr>
                <th>PAYMENT_NO</th>
                <th>DATE</th>
                <th>AMOUNT</th>
                <th>TYPE</th>
                <th>PRINT</th>
              </tr>
              <tr *ngFor="let payment of payments">
                <td>
                  {{payment.id}}
                </td>
                <td>
                  {{payment.effectiveDate}}
                </td>
                <td>
                  {{payment.amount}}
                </td>
                <td>
                  {{payment.paymentType.nameMl[translate.currentLang]}}
                </td>
                <td>
                </td>
              </tr>
            </jqxGrid>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #myWindow let-modal>
  <div class="modal-header">
    <h4 class="modal-title">{{(depositWithdraw == 'deposit' ? 'PROFILE.BUTTON.DEPOSIT' : 'PROFILE.BUTTON.WITHDRAW') |
      translate}}</h4>
    <button type="button" class="close" (click)="closeWindow()">
      <i class="hs-icon hs-icon-close"></i>
    </button>
  </div>
  <div class="modal-body">
    <ng-container *ngIf="depositWithdraw == 'deposit'; then deposit"></ng-container>
    <ng-container *ngIf="depositWithdraw == 'withdraw'; then withdraw"></ng-container>
  </div>
</ng-template>

<ng-template #deposit>
  <ng-container *ngIf="!selectedDepositType; then depositPaymentTypeSelect else depositView">
  </ng-container>
</ng-template>

<ng-template #depositPaymentTypeSelect>
  <mchDropDownList name="paymentMethods"
                   [placeHolder]="'Select payment method'"
                   [objectSource]="paymentTypes"
                   [displayFunc]="paymentTypeDisplayFunc"
                   [width]="'100%'"
                   [(ngModel)]="selectedDepositType">
  </mchDropDownList>
</ng-template>

<ng-template #depositView>
  <ng-container *ngIf="selectedDepositType.value == 'swift'; then depositSwift"></ng-container>
  <ng-container *ngIf="selectedDepositType.value == 'saved_card'; then depositCard"></ng-container>
</ng-template>

<ng-template #depositSwift>
  <div class="row mb-3">
    <div class="col">
      <p>Deposit to your account using the information below. You'll need to contact your bank for specific
        instructions.</p>
      <ul>
        <li>Be sure to include the "Reference" code given below - this code identifies the deposit with your account.
        </li>
        <!--<li>Don't exceed your daily or monthly funding limits. If you exceed the limits, your account will be frozen-->
        <!--until you get verified for higher limits, or until the funds are returned to you.-->
        <!--</li>-->
        <!--<li>Fees listed are what our bank charge us. Other banks used during the transfer may charge additional fees and-->
        <!--are out of our control.-->
        <!--</li>-->
        <li>Multiple deposits of the same amounts within a few days of each other may be delayed. If you must make
          multiple deposits, consider sending different amounts.
        </li>
        <li><strong>Important: The name on the bank account you are depositing from must match the name entered for
          verification on the Malevich account you are depositing into.</strong></li>
        <!--<li><strong>Revolut can accept international wire transfer deposits (EUR only), but withdrawals can only be sent-->
        <!--to SEPA bank accounts.</strong></li>-->
        <!--<li>Please be aware that Revolut can only accept Euro transfers. Transfer sent in any other currency will be-->
        <!--rejected and returned to you automatically.-->
        <!--</li>-->
      </ul>
    </div>
  </div>
  <!--<div class="row mb-3">-->
  <!--<div class="col">-->
  <!--<span class="d-block h3">Use this details to make transfer</span>-->
  <!--</div>-->
  <!--</div>-->
  <div class="row mb-3">
    <div class="col">
      <span class="d-block g-color-text g-font-size-13 mb-1">Beneficiary</span>
      <span class="d-block">{{parameters['revolut.account.beneficiary.name']}}</span>
    </div>
  </div>
  <div class="row mb-3">
    <div class="col">
      <span class="d-block g-color-text g-font-size-13 mb-1">IBAN</span>
      <span class="d-block">{{parameters['revolut.account.iban']}}</span>
    </div>
  </div>
  <div class="row mb-3">
    <div class="col">
      <span class="d-block g-color-text g-font-size-13 mb-1">BIC / SWIFT</span>
      <span class="d-block">{{parameters['revolut.account.bic']}}</span>
    </div>
    <div class="col-auto">
      <span class="d-block g-color-text g-font-size-13 mb-1">If your bank asks for your intermediary BIC</span>
      <span class="d-block">{{parameters['revolut.account.intermediary_bic']}}</span>
    </div>
  </div>
  <div class="row mb-3">
    <div class="col">
      <span class="d-block g-color-text g-font-size-13 mb-1">Beneficiary address</span>
      <span class="d-block">{{parameters['revolut.account.beneficiary.address']}}</span>
    </div>
  </div>
  <div class="row mb-3">
    <div class="col">
      <span class="d-block g-color-text g-font-size-13 mb-1">Bank / Payment institution</span>
      <span class="d-block">{{parameters['revolut.account.bank.name']}}</span>
    </div>
  </div>
  <div class="row mb-3">
    <div class="col">
      <span class="d-block g-color-text g-font-size-13 mb-1">Reference text</span>
      <span class="d-block mb-1">{{reference}} malevich.io</span>
      <p>IMPORTANT: This code identifies your deposit with your account. Include this code including "malevich.io"
        when submitting the wire transfer.</p>
    </div>
  </div>
</ng-template>

<ng-template #depositCard>
  <form #stripeTest="ngForm" (ngSubmit)="buy()" novalidate>
    <mchNumberInput
      mchRequired
      mchGreaterThan="0"
      name="amount"
      [(ngModel)]="amount"></mchNumberInput>
    <!--<input type="text" formControlName="name" placeholder="Jane Doe">-->
    <ngx-stripe-card [options]="cardOptions" [elementsOptions]="elementsOptions"></ngx-stripe-card>
    <mchButton [submitForm]="stripeTest">
      BUY
    </mchButton>
  </form>
</ng-template>

<ng-template #withdraw>
  <div class="row mb-3">
    <div *ngIf="withdrawMethods && withdrawMethods.length" class="col">
      <mchDropDownList name="paymentMethods"
                       [objectSource]="withdrawMethods"
                       [displayFunc]="paymentMethodDisplayFunc"
                       [width]="'100%'"
                       [ngModel]="newPayment.paymentMethod"
                       (ngModelChange)="newPayment.paymentMethod=$event">
      </mchDropDownList>
    </div>
    <div class="col-auto">
      <mchButton
        class="btn btn-block u-btn-primary g-font-size-12 h-100"
        (onClick)="addAccount()"
        [height]="null">
        {{'PROFILE.BUTTON.ADD_ACCOUNT' | translate}}
      </mchButton>
    </div>
  </div>
  <div class="row mb-3">
    <div class="col">
      <span>Amount:</span>
      <mchNumberInput
        class="amountInput"
        [ngModel]="-newPayment?.amount"
        (ngModelChange)="newPayment.amount=-$event"></mchNumberInput>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <mchButton #SendButton
                 class="btn btn-block u-btn-primary g-font-size-12 text-uppercase g-py-15 g-px-5"
                 (onClick)="sendWithdraw()"
                 [height]="null">
        {{'PROFILE.BUTTON.CONFIRM' | translate}}
      </mchButton>
    </div>
  </div>
</ng-template>

<ng-template #addAccountModal let-modal>
  <div class="modal-body">
    <app-profile-payment-account-edit (onSubmit)="accountCreated($event)"
                                      (onCancel)="accountCreationCanceled()">
    </app-profile-payment-account-edit>
  </div>
</ng-template>

